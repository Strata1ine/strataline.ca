---
import { parseHTML } from "linkedom";
import { setAttrElements } from "~/util/processHTML";

import Container, { ContainerVariant } from "~/components/div/Container.astro";
import ContainerTitle from "~/components/div/ContainerTitle.astro";
import { Pos } from "~/components/variants.ts";

const { title, variant = Pos.Left, speed = 0.4, ...slot } = Astro.props;

const html = await Astro.slots.render("default");
const { document } = parseHTML(html);

const images = document.querySelectorAll("img");

setAttrElements(
  images,
  "class",
  `max-w-[150vw] sm:!max-w-[35vw] !max-h-[60vh] rounded-sm object-cover`,
);
setAttrElements(images, "draggable", `false`);
---

<Container variant={ContainerVariant.Max} {...slot}>
  <ContainerTitle variant={variant} title={title} />
  <div class="cursor-grab contain-paint" data-carousel-wrapper>
    <div
      class="flex touch-pan-y gap-8 will-change-transform select-none sm:h-120 sm:gap-10 xl:h-150"
      data-carousel
      data-carousel-speed={speed}
    >
      <Fragment set:html={document} />
    </div>
  </div>
</Container>
