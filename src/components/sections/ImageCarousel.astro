---
import { parseHTML } from "linkedom";
import { setAttrElements } from "~/util/processHTML";

import Container, { ContainerVariant } from "~/components/div/Container.astro";
import ContainerTitle from "~/components/div/ContainerTitle.astro";
import { Pos } from "~/components/variants.ts";

const { title, variant = Pos.Left, speed = 0.4, ...slot } = Astro.props;

const html = await Astro.slots.render("default");
const { document } = parseHTML(html);

const images = document.querySelectorAll("img");

setAttrElements(images, "class", `max-w-[70vw] !w-120 rounded-sm object-cover`);

setAttrElements(images, "draggable", `false`);
---

<Container
  class="overflow-clip contain-paint"
  variant={ContainerVariant.Max}
  {...slot}
>
  <ContainerTitle variant={variant} title={title} />
  <div
    class="flex h-110 cursor-grab touch-none gap-6 will-change-transform select-none sm:h-120 xl:h-150"
    data-carousel
    data-carousel-moveable
    data-carousel-speed={speed}
  >
    <Fragment set:html={document} />
  </div>
</Container>
