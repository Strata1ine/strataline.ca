---
import { getCollection } from "astro:content";
import Service from "~/components/nav/Service.astro";
import { Pos } from "~/components/variants.ts";
import ServiceGallery from "~/components/nav/ServiceGallery.astro";

const { title, titlePos = Pos.Left } = Astro.props;
const [index] = await getCollection("index");
const serviceData = await getCollection("services");

const services = serviceData.filter(
  (service) =>
    !index.data.popular.some((pattern) => service.slug.includes(pattern)),
);

const { ...slot } = Astro.props;
---

<ServiceGallery title={title} titlePos={titlePos} {...slot}>
  {
    services.map((service: any, _) => (
      <Service
        data={service.data}
        slug={service.slug}
      />
    ))
  }
  <slot name="top" slot="top" />
  <slot name="bottom" slot="bottom" />
</ServiceGallery>
