---
import { getCollection } from "astro:content";
import { Image } from "astro:assets";
import Card from "./Card.astro";
import Container from "./layout/Container.astro";

const { title, popular, jealousTitle } = Astro.props;
const serviceData = await getCollection("services");

function next(i: number) {
  return i % 2 === 0 ? "left" : "right";
}

const popularServices = serviceData.filter((service) =>
  popular.some((pattern) => service.slug.includes(pattern)),
);

const services = serviceData.filter((service) =>
  popular.some((pattern) => !service.slug.includes(pattern)),
);
---

<Container title={title}>
  {
    popularServices.map((service: any, i) => (
      <Card
        title={service.data.title}
        description={service.data.description}
        variant={next(i)}
      >
        <Image src={service.data.cover} alt={service.data.alt} />
      </Card>
    ))
  }
</Container>

<Container title={jealousTitle}>
  {services.map((service: any, i) => <h1 />)}
</Container>
